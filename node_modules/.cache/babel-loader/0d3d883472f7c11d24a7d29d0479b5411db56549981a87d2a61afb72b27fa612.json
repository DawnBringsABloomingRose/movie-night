{"ast":null,"code":"var _jsxFileName = \"/home/emily/Documents/programming/rails/movie-night/app/javascript/components/LikeButton.jsx\";\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nimport React from \"react\";\nimport { Button, Space, Badge } from \"antd\";\nimport { ArrowUpOutlined } from '@ant-design/icons';\nvar LikeButton = /*#__PURE__*/function (_React$Component) {\n  _inherits(LikeButton, _React$Component);\n  var _super = _createSuper(LikeButton);\n  function LikeButton() {\n    var _this;\n    _classCallCheck(this, LikeButton);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      status: \"nolike\",\n      style: {},\n      onClickEvent: _this.createLike,\n      likes: []\n    };\n    _this.createLike = function () {\n      var like = {\n        suggestion_id: _this.props.suggestion_id\n      };\n      var url = \"api/v1/likes\";\n      fetch(url, {\n        method: \"post\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(like)\n      }).then(function (data) {\n        if (data.ok) {\n          _this.getLikes();\n          return data.json();\n        }\n        throw new Error(\"Network error.\");\n      });\n    };\n    _this.deleteLike = function () {\n      var id = _this.state.likes.find(function (el) {\n        return el.user_id == _this.props.currentUser;\n      }).id;\n      var url = \"api/v1/likes/\".concat(id);\n      fetch(url, {\n        method: \"delete\"\n      }).then(function (data) {\n        if (data.ok) {\n          _this.getLikes();\n          return data.json();\n        }\n        throw new Error(\"Network error.\");\n      });\n    };\n    _this.getLikes = function () {\n      var url = 'api/v1/likes/index/' + _this.props.suggestion_id;\n      fetch(url, {\n        method: 'get'\n      }).then(function (data) {\n        if (data.ok) {\n          return data.json();\n        }\n        throw new Error('Network error.');\n      }).then(function (data) {\n        _this.updateState(data);\n      });\n    };\n    _this.updateState = function (likes) {\n      //console.log(likes)\n      _this.setState(function () {\n        return {\n          likes: likes\n        };\n      });\n      if (likes.some(function (el) {\n        return el.user_id == _this.props.currentUser;\n      })) {\n        _this.setState(function () {\n          return {\n            status: \"liked\",\n            style: {\n              background: \"aqua\",\n              borderColor: \"red\"\n            },\n            onClickEvent: _this.deleteLike\n          };\n        });\n      } else {\n        //console.log(likes);\n        _this.setState(function () {\n          return {\n            status: \"nolike\",\n            style: {},\n            onClickEvent: _this.createLike\n          };\n        });\n      }\n    };\n    _this.likeHandler = function () {\n      if (_this.state.status == \"liked\") {\n        _this.deleteLike;\n      } else {\n        _this.createLike;\n      }\n    };\n    return _this;\n  }\n  _createClass(LikeButton, [{\n    key: \"componentDidMount\",\n    value:\n    //call update on load, and everytime create or delete likes\n    //update: get all the likes, set the state depending on whether the currentuser liked it\n    function componentDidMount() {\n      this.getLikes();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Button, {\n        shape: \"circle\",\n        onClick: this.state.onClickEvent,\n        icon: /*#__PURE__*/React.createElement(ArrowUpOutlined, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 72\n          }\n        }),\n        className: this.state.status,\n        style: this.state.style,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 9\n        }\n      }, this.state.likes.length));\n    }\n  }]);\n  return LikeButton;\n}(React.Component);\nexport default LikeButton;","map":{"version":3,"names":["React","Button","Space","Badge","ArrowUpOutlined","LikeButton","_React$Component","_inherits","_super","_createSuper","_this","_classCallCheck","_len","arguments","length","args","Array","_key","call","apply","concat","state","status","style","onClickEvent","createLike","likes","like","suggestion_id","props","url","fetch","method","headers","body","JSON","stringify","then","data","ok","getLikes","json","Error","deleteLike","id","find","el","user_id","currentUser","updateState","setState","some","background","borderColor","likeHandler","_createClass","key","value","componentDidMount","render","createElement","Fragment","shape","onClick","icon","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","className","Component"],"sources":["/home/emily/Documents/programming/rails/movie-night/app/javascript/components/LikeButton.jsx"],"sourcesContent":["import React from \"react\";\nimport {Button, Space, Badge} from \"antd\";\nimport { ArrowUpOutlined } from '@ant-design/icons';\n\nclass LikeButton extends React.Component {\n\n    state = {\n        status: \"nolike\",\n        style: {},\n        onClickEvent: this.createLike,\n        likes: [],\n    }\n\n    createLike = () => {\n        let like = {suggestion_id: this.props.suggestion_id};\n        const url = \"api/v1/likes\";\n        fetch(url, {\n          method: \"post\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify(like),\n        })\n          .then((data) => {\n            if (data.ok) {\n              this.getLikes();\n              return data.json();\n            }\n            throw new Error(\"Network error.\");\n          });\n    }\n\n    deleteLike = () => {\n        const id = this.state.likes.find((el) => el.user_id == this.props.currentUser).id;\n        const url = `api/v1/likes/${id}`;\n        fetch(url, {\n          method: \"delete\",\n        })\n          .then((data) => {\n            if (data.ok) {\n              this.getLikes();\n              return data.json();\n            }\n            throw new Error(\"Network error.\");\n          });\n    }\n\n    getLikes = () => {\n      const url = 'api/v1/likes/index/' + this.props.suggestion_id\n      fetch(url, {\n        method: 'get',\n      }).then((data) => {\n        if(data.ok) {\n          return data.json();\n        }\n        throw new Error('Network error.')\n      }).then((data)=> {\n        this.updateState(data)\n      }); \n    }\n\n    updateState = (likes) => {\n      //console.log(likes)\n      this.setState(() => ({\n        likes: likes,\n      }))\n\n      if (likes.some((el) => {\n        return el.user_id == this.props.currentUser\n      })) {\n        this.setState(() => ({\n            status:\"liked\",\n            style: {background: \"aqua\", borderColor: \"red\"},\n            onClickEvent: this.deleteLike,\n        }));\n    }\n    else {\n      //console.log(likes);\n        this.setState(() => ({\n            status:\"nolike\",\n            style: {},\n            onClickEvent: this.createLike\n        }))\n    }\n\n    };\n\n    //call update on load, and everytime create or delete likes\n    //update: get all the likes, set the state depending on whether the currentuser liked it\n    componentDidMount() {\n        this.getLikes();\n    }\n\n    likeHandler = () => {\n        if (this.state.status == \"liked\") {\n            this.deleteLike;\n        }\n        else {\n            this.createLike;\n        }\n    }\n\n    render() {\n        return(<>\n        <Button shape=\"circle\" onClick={this.state.onClickEvent} icon={<ArrowUpOutlined />} className={this.state.status} style={this.state.style}>{this.state.likes.length}</Button>\n        </>)\n    }\n}\n\nexport default LikeButton;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}